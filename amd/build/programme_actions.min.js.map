{"version":3,"file":"programme_actions.min.js","sources":["../src/programme_actions.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module formfield\n *\n * @module     customfield_sprogramme/formfield\n * @copyright  2025 Bas Brands <bas@sonsbeekmedia.nl>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport Manager from 'customfield_sprogramme/manager';\nimport History from 'customfield_sprogramme/history';\nimport {getString} from 'core/str';\nimport Modal from 'core/modal';\n\n/*\n * Initialise\n * @param {HTMLElement} element The element.\n * @param {String} courseid The courseid.\n */\nconst init = async() => {\n    document.addEventListener('click', async(event) => {\n        const editaction = event.target.closest('[data-action=\"editprogramme\"]');\n        if (editaction) {\n            const courseid = editaction.dataset.courseid;\n            await getEditor(editaction, courseid);\n            event.preventDefault();\n        }\n        const actionBtn = event.target.closest('[data-action=\"showrfc\"]');\n        if (actionBtn) {\n            const rfcid = parseInt(actionBtn.dataset.rfcid);\n            const courseid = actionBtn.dataset.courseid;\n            await showHistory(rfcid, courseid);\n            event.preventDefault();\n        }\n    });\n};\n\nconst showHistory = async(rfcid, courseid) => {\n    await getProgrammeHistory(rfcid, courseid);\n    const modalContent = document.querySelector('[data-region=\"history\"]');\n\n    const modal = await Modal.create({\n        large: true,\n        title: getString('history', 'customfield_sprogramme'),\n        body: modalContent,\n        show: true,\n    });\n    const modalElement = modal.getModal()[0];\n    modalElement.classList.add('modal-customfield_sprogramme_history');\n};\n\nconst getEditor = async(element, courseid) => {\n    await getProgramme(element, courseid);\n    const modalContent = document.querySelector('[data-region=\"app\"]');\n    const modalHeader = document.querySelector('[data-region=\"modalheader\"]');\n\n    const modal = await Modal.create({\n        large: true,\n        title: getString('editprogramme', 'customfield_sprogramme'),\n        body: modalContent,\n        show: true,\n    });\n\n    const modalElement = modal.getModal()[0];\n    modalElement.classList.add('modal-customfield_sprogramme_editor');\n    const header = modalElement.querySelector('[data-region=\"header\"]');\n    const title = modalElement.querySelector('[data-region=\"title\"]');\n    if (title) {\n        // Add the icone after the title Element.\n        header.insertBefore(modalHeader, title.nextSibling);\n    }\n\n    document.addEventListener('closeform', () => {\n        modal.hide();\n    });\n};\n\n/**\n * Get the programme.\n * @param {HTMLElement} element The element.\n * @param {String} courseid The courseid.\n * @return {Promise} The programme.\n */\nconst getProgramme = async(element, courseid) => {\n    Manager.init(element, courseid);\n};\n\n/**\n * Get the programme history.\n * @param {int} rfcid The Rfc id.\n * @param {int} courseid The course id.\n */\nconst getProgrammeHistory = async(rfcid, courseid) => {\n    History.init(rfcid, courseid);\n};\n\nexport default {\n    init: init,\n};"],"names":["showHistory","async","rfcid","courseid","getProgrammeHistory","modalContent","document","querySelector","Modal","create","large","title","body","show","getModal","classList","add","getEditor","element","getProgramme","modalHeader","modal","modalElement","header","insertBefore","nextSibling","addEventListener","hide","init","editaction","event","target","closest","dataset","preventDefault","actionBtn","parseInt"],"mappings":";;;;;;;qNAkDMA,YAAcC,MAAMC,MAAOC,kBACvBC,oBAAoBF,MAAOC,gBAC3BE,aAAeC,SAASC,cAAc,kCAExBC,eAAMC,OAAO,CAC7BC,OAAO,EACPC,OAAO,kBAAU,UAAW,0BAC5BC,KAAMP,aACNQ,MAAM,KAEiBC,WAAW,GACzBC,UAAUC,IAAI,yCAGzBC,UAAYhB,MAAMiB,QAASf,kBACvBgB,aAAaD,QAASf,gBACtBE,aAAeC,SAASC,cAAc,uBACtCa,YAAcd,SAASC,cAAc,+BAErCc,YAAcb,eAAMC,OAAO,CAC7BC,OAAO,EACPC,OAAO,kBAAU,gBAAiB,0BAClCC,KAAMP,aACNQ,MAAM,IAGJS,aAAeD,MAAMP,WAAW,GACtCQ,aAAaP,UAAUC,IAAI,6CACrBO,OAASD,aAAaf,cAAc,0BACpCI,MAAQW,aAAaf,cAAc,yBACrCI,OAEAY,OAAOC,aAAaJ,YAAaT,MAAMc,aAG3CnB,SAASoB,iBAAiB,aAAa,KACnCL,MAAMM,WAURR,aAAelB,MAAMiB,QAASf,6BACxByB,KAAKV,QAASf,WAQpBC,oBAAsBH,MAAMC,MAAOC,6BAC7ByB,KAAK1B,MAAOC,wBAGT,CACXyB,KA9ES3B,UACTK,SAASoB,iBAAiB,SAASzB,MAAAA,cACzB4B,WAAaC,MAAMC,OAAOC,QAAQ,oCACpCH,WAAY,OACN1B,SAAW0B,WAAWI,QAAQ9B,eAC9Bc,UAAUY,WAAY1B,UAC5B2B,MAAMI,uBAEJC,UAAYL,MAAMC,OAAOC,QAAQ,8BACnCG,UAAW,OACLjC,MAAQkC,SAASD,UAAUF,QAAQ/B,OACnCC,SAAWgC,UAAUF,QAAQ9B,eAC7BH,YAAYE,MAAOC,UACzB2B,MAAMI"}