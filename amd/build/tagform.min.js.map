{"version":3,"file":"tagform.min.js","sources":["../src/tagform.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tag Form helpers.\n *\n * @module     customfield_sprogramme/tagform\n * @copyright  2025 Bas Brands <bas@sonsbeekmedia.nl>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nclass TagForm {\n\n    /**\n     * Constructor.\n     */\n    constructor() {\n        this.addEventListeners();\n    }\n\n    /**\n     * Add event listeners to the form.\n     */\n    addEventListeners() {\n        const form = document.querySelector('[data-region=\"tagform\"]');\n        if (!form) {\n            return;\n        }\n        if (form.dataset.initialised) {\n            // The form is already initialised, no need to add event listeners again.\n            return;\n        }\n        form.dataset.initialised = true;\n\n        // Handle the form submission.\n        const search = form.querySelector('input[type=\"search\"]');\n        search.addEventListener('input', (e) => {\n            const input = e.target.closest('input');\n            if (input) {\n                this.typeahead(input);\n            }\n        });\n    }\n\n    /**\n     * Typeahead.\n     *\n     * @param {object} input The input that was changed.\n     * @return {void}\n     */\n    typeahead(input) {\n        const value = input.value;\n        const form = document.querySelector('[data-region=\"tagform\"]');\n        const options = form.querySelectorAll('[data-option]');\n        options.forEach(option => {\n            this.removeMatchBold(option);\n            if (option.textContent.toLowerCase().includes(value.toLowerCase())) {\n                option.classList.remove('d-none');\n                this.makeMatchBold(option, value);\n            } else {\n                option.classList.add('d-none');\n            }\n        });\n    }\n\n    /**\n     * Remove the match bold.\n     * @param {object} option The option.\n     * @return {void}\n     */\n    removeMatchBold(option) {\n        option.innerHTML = option.textContent;\n    }\n\n\n    /**\n     * Make the match bold.\n     * @param {object} option The option.\n     * @param {string} value The value.\n     * @return {void}\n     */\n    makeMatchBold(option, value) {\n        const text = option.textContent;\n        const index = text.toLowerCase().indexOf(value.toLowerCase());\n        const first = text.slice(0, index);\n        const match = text.slice(index, index + value.length);\n        const last = text.slice(index + value.length);\n        option.innerHTML = first + '<strong>' + match + '</strong>' + last;\n    }\n}\n\nconst init = () => {\n    new TagForm();\n    // Ensure the tag form is initialised.\n};\n\nexport default {\n    init: init\n};"],"names":["TagForm","constructor","addEventListeners","form","document","querySelector","dataset","initialised","addEventListener","e","input","target","closest","typeahead","value","querySelectorAll","forEach","option","removeMatchBold","textContent","toLowerCase","includes","classList","remove","makeMatchBold","add","innerHTML","text","index","indexOf","first","slice","match","length","last","init"],"mappings":";;;;;;;;MAuBMA,QAKFC,mBACSC,oBAMTA,0BACUC,KAAOC,SAASC,cAAc,+BAC/BF,eAGDA,KAAKG,QAAQC,mBAIjBJ,KAAKG,QAAQC,aAAc,EAGZJ,KAAKE,cAAc,wBAC3BG,iBAAiB,SAAUC,UACxBC,MAAQD,EAAEE,OAAOC,QAAQ,SAC3BF,YACKG,UAAUH,UAW3BG,UAAUH,aACAI,MAAQJ,MAAMI,MACPV,SAASC,cAAc,2BACfU,iBAAiB,iBAC9BC,SAAQC,cACPC,gBAAgBD,QACjBA,OAAOE,YAAYC,cAAcC,SAASP,MAAMM,gBAChDH,OAAOK,UAAUC,OAAO,eACnBC,cAAcP,OAAQH,QAE3BG,OAAOK,UAAUG,IAAI,aAUjCP,gBAAgBD,QACZA,OAAOS,UAAYT,OAAOE,YAU9BK,cAAcP,OAAQH,aACZa,KAAOV,OAAOE,YACdS,MAAQD,KAAKP,cAAcS,QAAQf,MAAMM,eACzCU,MAAQH,KAAKI,MAAM,EAAGH,OACtBI,MAAQL,KAAKI,MAAMH,MAAOA,MAAQd,MAAMmB,QACxCC,KAAOP,KAAKI,MAAMH,MAAQd,MAAMmB,QACtChB,OAAOS,UAAYI,MAAQ,WAAaE,MAAQ,YAAcE,mBASvD,CACXC,KANS,SACLnC"}